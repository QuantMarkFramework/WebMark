{% extends "rest_framework/base.html" %}

{% block title %}QuantMark2 Detail: {{ batch_id }}{% endblock %}

{% block content %}
<div class="starter-template">
  <h1>Batch {{ batch_id }} details:</h1>
  <div style="width: 20%; float: left; margin: 5%">
    <h3>General info</h3>
    <table>
      <tr>
        <td>Created: </td>
        <td>{{ results.0.created }}</td>
      </tr>
      <tr>
        <td>Batch id: </td>
        <td>{{ batch_id }}</td>
      </tr>
      <tr>
        <td>optimizer: </td>
        <td>{{ results.0.optimizer }}</td>
      </tr>
      <tr>
        <td>Tequila version: </td>
        <td>{{ results.0.tqversion }}</td>
      </tr>
    </table>

    <h3>Per iteration info</h3>
    {% for result in results %}
    <table>
      <tr>
        <td>energy: </td>
        <td>{{ result.energy }}</td>
      </tr>
      <tr>
        <td>distance: </td>
        <td>{{ result.distance }}</td>
      </tr>
      <tr>
        <td>fun: </td>
        <td>{{ result.fun }}</td>
      </tr>
      <tr>
        <td>nfev: </td>
        <td>{{ result.nfev }}</td>
      </tr>
    </table>
    <hr>
    {% endfor %}
  </div>
  <div style="width: 60%; float: left; margin: 5%">
    <div id="dis-energy-chart"></div>
  </div>
</div>
{% endblock %}

{% block script %}
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load('current', { 'packages': ['corechart'] });
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {
    var energies = {{ energies }}
    var distances = {{ distances }}

  var data = new google.visualization.DataTable();
  data.addColumn('number', '')
  data.addColumn('number', '')

  for (i = 0; i < energies.length; i++) {
    data.addRow([distances[i], energies[i]])
  }

  const options = {
    width: 1000,
    height: 1000,
    pointsVisible: true,
    legend: { position: 'bottom' },

    hAxis: {
      title: 'Distance',
    },
    vAxis: {
      title: "Energy",
    },
    explorer: {
      keepInBounds: true,
    }
  };

  var chart = new google.visualization.LineChart(document.getElementById('dis-energy-chart'))
  chart.draw(data, options)
  }

</script>
{% endblock%}